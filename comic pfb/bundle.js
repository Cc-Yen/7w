(()=>{var e=void 0===document.pp?decodeURIComponent(window.location.search).substring(1).split("&"):document.pp;function t(e,t,a,i){e.meta=void 0===i?{}:i,e.btnDATA=void 0===t?[]:t,e.id_選中鈕=0,e.max行程_夾住模式={x:0,y:0},e.max行程_滾動項目堆={x:0,y:0},e.pos原點_滾動項目堆={x:0,y:0},e.dir={x:1,y:0},e._項目標題文=a._項目標題文,e.sp_背景框=a.sp_背景框,e.sp_前景項目=a.sp_前景項目,e.iColor=a.color,e.name_IO溝通,e.data_由文件內容={},e.key_類別資料,e.data_目前選中類別的章關,e.sp_供主類別前景項目;var r,o,s=e.getElementsByClassName("iBn");e.Init=function(){var t=s[0],n=s[s.length-1];t.getBoundingClientRect().left==n.getBoundingClientRect().left&&t.getBoundingClientRect().top==n.getBoundingClientRect().top||(clearInterval(o),console.log("scrl.id ",e.id),e.is_水平模式=t.getBoundingClientRect().top==n.getBoundingClientRect().top,console.log("scrl.is_水平模式 ",e.is_水平模式),e.unit_travel=e.is_水平模式?s[0].getBoundingClientRect().width:s[0].getBoundingClientRect().height,console.log("scrl.unit_travel  ",e.unit_travel),r=.5*e.unit_travel,e.is_水平模式?e.scrollLeft+=e.unit_travel:e.scrollTop+=e.unit_travel)},o=setInterval(e.Init,49),e.Set_項目=function(t,n){var a=e.btnDATA[t.id];t.innerHTML=a?CcUtility.Get_詞嵌入文(e._項目標題文,void 0===n?a._標題變數值:n):t.id};for(var l=0;l<s.length;l++)e.Set_項目(s[l],[l+1]);return e.Reset_BtnDATA=function(){for(var t=0;t<s.length;t++)e.Set_項目(s[t])},e.限速=function(){return e.Update_ScrollView(),CcUtility.Clamp(arguments[0],r,-r)},e.releaseTime=a.releaseTime,e.力衰退intervalTime=a.力衰退intervalTime,e.On拖力漸緩衰退=function(){var t=this,n=t.releaseTime,a=setInterval((function(){t.scrollBy(e.限速(t.lastMovement.x),e.限速(t.lastMovement.y)),(n-=t.力衰退intervalTime)<=0&&clearInterval(a)}),t.力衰退intervalTime)},e.Update_ScrollView=function(){var t=e.btnDATA.length,n=this.is_水平模式?e.scrollLeft:e.scrollTop;n>1.5*this.unit_travel?(s[0].id=(parseInt(s[s.length-1].id)+1)%t,e.Set_項目(s[0]),e.insertAdjacentElement("beforeend",s[0]),e.scrollLeft-=this.unit_travel):n<.5*this.unit_travel&&(s[s.length-1].id=(parseInt(s[0].id)+t-1)%t,e.Set_項目(s[s.length-1]),e.insertAdjacentElement("afterbegin",s[s.length-1]),e.scrollLeft+=this.unit_travel)},e.isMouseDown=!1,e.isMouseUP=!1,e.mouseMoveDelta=0,e.addEventListener("mouseup",n),e.addEventListener("mousedown",n),e.addEventListener("mousemove",n),e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",n),e.addEventListener("scroll",e.Update_ScrollView),e}function n(e){var t=e.currentTarget;switch(e.type){case"mousemove":t.isMouseDown&&(t.isMouseUP||(t.scrollBy(t.限速(-e.movementX),t.限速(-e.movementY)),t.lastMovement={x:-e.movementX,y:-e.movementY}));break;case"mouseup":t.isMouseUP=!0,t.On拖力漸緩衰退();break;case"mousedown":t.isMouseDown=!0,t.isMouseUP=!1;break;case"mouseenter":t.isMouseDown=t.isMouseUP=!1;break;case"mouseleave":t.isMouseDown&&!t.isMouseUP&&(t.isMouseUP=!0,t.On拖力漸緩衰退())}}function a(){}function i(e){e.forEach((function(e){e.visible=!1}),this),e.reverse();var t=e.getAt(0),n=e.getAt(1);this._字身=Math.round(Math.max(t.centerX-n.centerX,n.centerY-t.centerY)),this._字句=e,this._橫數=Math.ceil(e.j_h/this._字身),this._豎數=Math.ceil(e.j_w/this._字身),this._字句寬=this._豎數*this._字身,this._可見豎數=Math.round(e.parent.j_w/this._字身),this._可見字數=this._可見豎數*this._橫數}console.log(e),a.prototype.Is_夾住限制=function(){var e=!1,t=.2*this.unit_travel,n=Phaser.Math.RoundTo(this.pnl_btnGroup.p);return is_水平模式?this.pnl_btnGroup.x=n.x>0?(e=n.x>max行程_夾住模式.x)?n.x>max行程_夾住模式.x+t?max行程_夾住模式+t:n.x-1:n.x:(e=n.x<-max行程_夾住模式.x)?n.x<-max行程_夾住模式.x-t?-max行程_夾住模式+t:n.x+1:n.x:this.pnl_btnGroup.y=n.y>0?(e=n.y>max行程_夾住模式.y)?n.y>max行程_夾住模式.y+t?max行程_夾住模式+t:n.y-1:n.y:(e=n.y<-max行程_夾住模式.y)?n.y<-max行程_夾住模式.y-t?-max行程_夾住模式+t:n.y+1:n.y,this.scene.input.setDraggable(this.pnl_btnGroup,!e),e},a.prototype.GetSnapedTravel=function(){return Phaser.Math.RoundTo(this.pnl_btnGroup.p/this.unit_travel)},a.prototype.UpdatePosSide=function(e){return e*this.unit_travel},a.prototype.SetPos=function(e,t){this.is_水平模式?e.x=t:e.y=t},a.prototype.ResetItemData=function(e,t,n,a,i,r){if(data_目前選中類別的章關=e,void 0===n)n=l;else for(var o=n.length-(n.length-l.length);o<n.length;o++)l[o]=l[0];if(null!=sp_供主類別前景項目)for(i=new Sprite[data_目前選中類別的章關[0].length],o=0;o<data_目前選中類別的章關[0].length;o++)i[o]=sp_供主類別前景項目[">"];sp_前景項目=void 0===i?sp_前景項目:i,sp_背景框=void 0===a?sp_背景框:a,data_目前選中類別的章關[0].length,id_獨特.length,id_獨特=data_目前選中類別的章關[0],iLable=data_目前選中類別的章關[1];var s="s格_"+name_IO溝通;if(CcLoader.app_cfg.ContainsKey(s))for(o=0;o<iLable.length;o++)iLable[o]=string.Format(CcLoader.app_cfg[s],iLable[o]);is_Srolling||(is_Srolling=!0,StartCoroutine(SrollingResetItems(t,n,r)))},i._目前步=0,i._目前步已讀完td=0,i._每字讀秒=490,i.prototype._跑字句=function(){this.travels=0,this.runtext=x.time.events.loop(142,(function(){this._字句.getAt(this.travels).visible=!0,this.travels++,this.travels>=this._可見字數&&1==this.travels%this._橫數&&(this._字句.x=this._字句.x+this._字身),this.travels>=this._字句.length&&(i._目前步已讀完td+=1,x.time.events.remove(this.runtext),console.log(i._目前步已讀完td,"this.目前步已讀完成字句框數"))}),this)},i.prototype.歸零=function(){this._字句.foreach((function(e){e.visible=!1}),this),this.pos_文字偏移量=0};var r,o,s,l=[16711680,16737792,16776960,65280,255,1539248,10027212,4509429,7402239,16751052],c=Object.freeze({初始化:0,房桌訊:1,進入遊戲:2,押注開獎:3,即時訊息:4,放棄投降:5,每手計時:6}),d=[],h=[];function u(){r=x.cache.getJSON("j_共用_話圖資源頁").textures;for(var e=x.cache.getJSON("j_共用_話圖資源頁").BMD,t=0;t<e.length;t++)g(e[t])}function _(e){o=x.cache.getJSON("j_lp"),r=o.textures.concat(x.cache.getJSON("j_共用_話圖資源頁").textures),d=o.BMD,s=o.GB,o.steps;for(var t=0;t<o.textures.length;t++){var n=r[t];console.log("j_切圖塊資訊.image, j_切圖塊資訊.url",n.image,n.url),x.load.image(n.image,n.url)}x.load.onLoadComplete.add(m),x.load.start()}function m(){for(var e=0;e<d.length;e++)g(d[e]);var t=Object.getOwnPropertyNames(s);for(e=0;e<t.length;e++)s.name=t[e];!function(){for(var e=o.steps,t=0;t<e.length;t++){var n=JSON.parse(JSON.stringify(e[t])),a=x.add.group(x.world,n.name);a.tn=[],a.td=[],a.ts=[];for(var i=0;i<n.parts.length;i++){var r=f(n.parts[i],a);v(r,n.parts[i]),r.alpha=0,r.visible=!1,/^group_p\d+_step\d+_td\d+/.test(r.name)?(a.add(r),a.td.push(r),r.forEach((function(e){0==e.name.indexOf("group_話引箭號")&&(e.alpha=0,r._話引箭號=e)}))):/^group_p\d+step\d+準切塊的點陣圖\d+/.test(r.name)?(a.addAt(r,0),r.alpha=1,r.visible=!0):/^group_p\d+_step\d+_tn\d+/.test(r.name)?(a.addAt(r,1),a.tn.push(r),r.alpha=0,r.visible=!0):(a.addAt(r,1),a.ts.push(r),r.alpha=1,r.visible=!0)}a.json=n,h.push(a),a.alpha=0,a.visible=!1}setTimeout(A,1e3)}()}function g(e){for(var t=x.make.bitmapData(Math.ceil(e.w),Math.ceil(e.h),e.name,!0),n=e.parts,a=(e.name.indexOf("準切塊"),0);a<n.length;a++){var i=n[a],r=b(i.name),o=x.cache.getBitmapData(i.name);if(null!=r){var s=y(r,i,!0);t.copy(s,0,0,s.width,s.height,i.x,i.y,s.width,s.height,i.rot/180*-Math.PI,.5,.5)}else if(o)t.copy(o,0,0,o.width,o.height,i.x,i.y,o.width,o.height,i.rot/180*-Math.PI,.5,.5,i.sW,i.sH);else if("draw_circle"===i.name){var l=Math.ceil(.5*i.w);i.sH>i.sW&&(l=Math.ceil(l*i.sH),i.sW=i.sW/i.sH,i.sH=1);var c=Math.ceil(2*l),d=x.make.bitmapData(c,c);d.circle(l,l,l,"#"+p(i.R,i.G,i.B)),t.copy(d,0,0,c,c,i.x,i.y,c*i.sW,c*i.sH,i.rot/180*-Math.PI,.5,.5)}else if("draw_rect"===i.name){var h=x.make.bitmapData(i.w,i.h);h.fill(Math.max(16,i.R),Math.max(16,i.G),Math.max(16,i.B)),t.copy(h,0,0,i.w,i.h,i.x,i.y,i.w,i.h,i.rot/180*-Math.PI,.5,.5)}}return t}function p(e,t,n){return Math.max(16,e).toString(16)+Math.max(16,t).toString(16)+Math.max(16,n).toString(16)}function v(e,t){if(t.name,null!=e.length){var n=[];e.forEach((function(e){n.push(e)}),this),e.removeAll(),e.x=e.j_x-.5*t.w,e.y=e.j_y-.5*t.h;for(var a=0;a<n.length;a++){var i=n[a];e.add(i),i.x=i.j_x,i.y=i.j_y}}}function f(e,t){var n={},a=e.name,r=b(a),o=x.cache.getBitmapData(a);return r?n=y(r,e):o?(n=x.add.image(e.x,e.y,o)).anchor.set(.5,.5):n=function(e,t){var n,a=e.name,r=s[a],o=x.add.group(x.world,a);if(0===a.indexOf("mask_group_")&&(o.j_w=r.w,o.j_h=r.h,n=function(e,t){var n=e.name,a=(s[n],x.add.graphics(0,0,t));return a.beginFill(16717334),a.drawRect(.5*-e.w,.5*-e.h,e.w,e.h),a.endFill(),a}(e,o)),r.hasOwnProperty("parts"))for(var l=0;l<r.parts.length;l++){var c=r.parts[l],d=(c.name,f(c,o));w(d,c),o.add(d),null!=n&&(d.centerX=d.centerX-.5*n.width,d.centerY=d.centerY-.5*n.height,d.mask=n,d.j_w=c.w,d.j_h=c.h,/mask_group_字塊_p\d+_step\d+_td\d+/.test(a)&&(t._讀字機=new i(d)))}return w(o,e),o}(e,t),n.name=a,n.j_x=e.x,n.j_y=e.y,n._動畫=e["_動畫"],n}function b(e){for(var t=0;t<r.length;t++)for(var n=r[t].frames,a=0;a<n.length;a++){var i=n[a];if(e===i.filename)return{key_txr:r[t].image,_切圖塊:i}}return null}function y(e,t,n){var a=e["_切圖塊"],i=90==a.angle,r=(t.rot,Math.PI,i&&Math.PI,i?a.frame.h:a.frame.w),o=i?a.frame.w:a.frame.h,s=(r=Math.ceil(Math.abs(r*t.sW)),o=Math.ceil(Math.abs(o*t.sH)),x.make.bitmapData(r,o));s.copy(e.key_txr,a.frame.x,a.frame.y,a.frame.w,a.frame.h,.5*r,.5*o,a.frame.w,a.frame.h,i?.5*-Math.PI:0,.5,.5,t.sW,t.sH);var l=x.make.image(0,0,s);return t.hasOwnProperty("R")&&(l.tint="0x"+p(t.R,t.G,t.B)),l.anchor.setTo(.5),!0===n||(l.position.setTo(t.x,t.y),l.scale.setTo(t.sW,t.sH),l.angle=-t.rot),l}function w(e,t){e.scale.setTo(t.sW,t.sH),e.centerX=t.x,e.centerY=t.y,e.angle=-t.rot}var M,x=new Phaser.Game(800,600,Phaser.CANVAS,"comic",{preload:function(){document.body.addEventListener("click",c),x.stage.backgroundColor="#4488AA",console.log("歡迎進入",document.baseURI," 皮飛比的世界"),x.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,x.scale.pageAlignHorizontally=!0,x.scale.pageAlignVertically=!0,x.stage.disableVisibilityChange=!0,x.load.baseURL=k.baseURL,x.load.json("j_共用_話圖資源頁","../Game_Comics/Assets/CcTextAssets/_共用_話圖資源頁.json")},create:function(){for(var e=new Phaser.Loader(x),t=x.cache.getJSON("j_共用_話圖資源頁").textures,n=0;n<t.length;n++){var a=t[n];e.image(a.image,a.url)}e.onLoadComplete.add(u),e.start()}});function c(e){switch(console.log(e,e.target),e.target.id){case"btn MenuMain Start":menu_in=menu[param_lobby.Menu_GamePicking.id],loadDoc(void 0,k.Menu_GamePicking,menu_in,[SetMenuIO,[menu[param_lobby.Menu_Main.id],"777px","DownBack",C]]);break;case"btn MenuMain Help":menu_in=menu[param_lobby.Menu_Help.id],loadDoc(void 0,k.Menu_Help,menu_in,[SetMenuIO,[menu[param_lobby.Menu_Main.id],"777px","DownBack"]]);break;case"btn MenuMain Option":menu_in=menu[param_lobby.Menu_Options.id],loadDoc(void 0,k.Menu_Options,menu_in,[SetMenuIO,[menu[param_lobby.Menu_Main.id],"777px","DownBack"]]);break;case"btn MenuGamePicking Play":var t=document.getElementById("scrl 篇集索引").id_選中鈕,n=document.getElementById("scrl 章回索引").id_選中鈕,a=M.content[t][n].key;switch(a){case"":alert("本章回"+e品項狀態[a]+"可選擇其他已經開放的。");break;case"0":Go_觀遊聆戲(t,n);break;case"1":if(confirm("本回內容需要收一張觀聆票卷\n確定支付？"))if(uData.av_ticket){var r=new Date,o=(""+r.getFullYear()+(r.getMonth()+1)).substring(2);uData.id_篇集=t,uData.id_章回=n,WaitingServerResult(eCmdP.game_menu,eCS.進入聆遊觀戲,[eT.sr,eT.sr],[EncodeUtf8(o),EncodeUtf8(M.content[t][n].date_time)])}else alert("目前您沒有觀聆票卷")}break;case"btn MenuGamePicking Back":default:break;case"pop_m機台有人":e.target.classList.toggle("show")}"scrl 話頁"===e.target.parentNode.id&&(h.forEach((function(e,t,n){n[t].destroy(!0)})),h=[],i._目前步=0,i._目前步已讀完td=0,e.target.parentNode.id_選中鈕=e.target.id,document.getElementById("sel 選頁").innerHTML="目前選擇第"+(parseInt(e.target.id)+1)+" 話頁：",function(e){var t=new Phaser.Loader(x);t.json("j_lp","assets/CcTextAssets/Level_Chapter/act0/page"+e+".json"),t.onLoadComplete.add(_,this,0,e),t.start()}(parseInt(e.target.id)))}function C(){ExMenu(),Cc工具._載入("content.json","json",(function(e){var n=document.getElementById("scrl 篇集索引"),a=document.getElementById("scrl 章回索引");(M=e).part.sort((function(e,t){return e.no-t.no})),M.part.forEach((function(e){e.no=ch_數字[e.no+1]}));for(var i=0;i<M.content.length;i++)for(var r=0;r<M.content[i].length;r++){var o=M.content[i][r];M.content[i][r]=Object.assign({no:Get_中文數字(1+r)},o)}t(n,[],{_項目標題文:'                                <div style="width:100%; height:30%;"><b style="text-align: center; color:brown;">⌘{1}⌘ </b></div>                                <div style="width:88%; height:70%; justify-content:center;  align-items: center; display:flex;"><b style="color:yellow;">{0}</b></div>',releaseTime:490,力衰退intervalTime:49},"part"),t(a,[],{_項目標題文:'                                <div style="width:100%; height:20%; margin: 0 0;"><b style="text-align: center; color:lightgreen;">第{0}回</b></div>                                <div style="width:88%; height:40%;  align-items: center; justify-content:center; display:flex;"><b>{1}</b></div>                                <div style="width:100%; height:15%;color:blue;"><b>{2}票</b></div>                                <div style="width:100%; height:10%;color:lightred;"><b>人氣{3}點</b></div>                                <div style="width:100%; height:15%;">{4}</div>',releaseTime:490,力衰退intervalTime:49},"content"),O(n),O(a,n.id_選中鈕)}))}function A(){var e;(e=h[i._目前步]).visible=!0,e.alpha=1,e.getAt(0).visible=!0,e.getAt(0).alpha=1,function(e){x.add.tween(e).from({alpha:0},490,Phaser.Easing.Circular.InOut,!0).onComplete.add(P,null,null,e)}(e=h[i._目前步])}function P(e,t){if(0===e.tn.length)T(e.td.length>0?e:void 0);else{var n=e.tn[0];for(x.add.tween(n).to({alpha:1},490,Phaser.Easing.Circular.InOut,!0),x.add.tween(n).from({x:n._動畫.fX,y:n._動畫.fY,width:0,height:0,angle:n.angle-90},490,Phaser.Easing.Circular.InOut,!0).onComplete.add((function(){T(e.td.length>0?e:void 0)}));1<e.tn.length;index++)n=e.tn[1],x.add.tween(n).to({alpha:1},490,Phaser.Easing.Circular.InOut,!0),x.add.tween(n).from({x:n._動畫.fX,y:n._動畫.fY,alpha:0,width:0,height:0,angle:n.angle-90},490,Phaser.Easing.Circular.InOut,!0)}}function T(e,t){if(void 0!==e){var n=0,a=e.td[n];a.visible=!0,a.alpha=1,console.log(a.name,"_目前td字句框._讀字機.",a),x.add.tween(a).from({x:a._動畫.fX,y:a._動畫.fY,alpha:0,width:0,height:0},777,Phaser.Easing.Circular.InOut,!0).onComplete.add(I,null,null,a);var r=x.time.events.loop(280,(function(){1==a._讀字機.travels/a._讀字機._字句.length&&(i._目前步已讀完td>=e.td.length?(console.log("目前步已經讀完，換讀下步"),e.visible=!1,i._目前步++,i._目前步已讀完td=0,i._目前步>=h.length?i._目前步=0:setTimeout(A,490),x.time.events.remove(r)):(n+=1,(a=e.td[n]).visible=!0,a.alpha=1,x.add.tween(a).from({x:a._動畫.fX,y:a._動畫.fY,alpha:0,width:0,height:0},777,Phaser.Easing.Circular.InOut,!0).onComplete.add(I,null,null,a))),console.log(i._目前步已讀完td,"_目前td文具框讀字進度",e.td.length)}))}}function I(e,t){void 0===e._話引箭號?e._讀字機._跑字句():x.add.tween(e._話引箭號).to({alpha:1},490,Phaser.Easing.Power1,!0).onComplete.add(e._讀字機._跑字句,e._讀字機)}e[7],document.init=function(){},e[0]="debug","debug"!=e[0]&&connect((function(){console.log("cfg Rules _票auth_code：",e[3]);var t=parseInt(e[3],10);票碼=NaN===t?new Uint8Array([231,71,68,66]):new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255]),ws.send(new Uint8Array([eCmdP.authorize,0])),WaitingServerResult(eCmdP.authorize,eCmdS.授權AppGame,[eT.u4,eT.sr],[[255&t,t>>8&255,t>>16&255,t>>24&255],EncodeUtf8(e[2])])}));var k={baseURL:"https://raw.githubusercontent.com/Cc-Yen/7w/main//comic pfb/",Menu_Main:"https://raw.githubusercontent.com/Cc-Yen/7w/main/AppLobby/comic pfb/Menu_Main",Menu_TopBoard:"",Menu_Options:"",Menu_Store:"",Menu_Help:"",Menu_GamePicking:"https://raw.githubusercontent.com/Cc-Yen/7w/main/AppLobby/comic pfb/Menu_GamePicking",Menu_Game:""};function O(e,t){var n;void 0!==t?(t=parseInt(t),n=M[e.meta][t]):n=M[e.meta],e.btnDATA=[],console.log("_meta.名稱代號",n);for(var a=Object.getOwnPropertyNames(n[0]),i=0;i<n.length;i++){e.btnDATA.push({_標題變數值:[]});for(var r=0;r<a.length;r++){var o,s=a[r];switch(s){case"date_time":o=n[i][s].split(" ")[0];break;case"key":o=e品項狀態[n[i][s]];break;default:o=n[i][s]}e.btnDATA[i]._標題變數值.push(o)}}var l=e.getElementsByClassName("iBn");for(i=e.btnDATA.length;i<l.length;i++)e.btnDATA.push(null);e.Reset_BtnDATA()}})();